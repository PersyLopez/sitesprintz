[dotenv@17.2.3] injecting env (18) from .env -- tip: üîê encrypt with Dotenvx: https://dotenvx.com
[dotenv@17.2.3] injecting env (0) from .env -- tip: ‚úÖ audit secrets and track compliance: https://dotenvx.com/ops
‚úÖ Google OAuth configured
üìç Callback URL: https://tenurial-subemarginate-fay.ngrok-free.dev/auth/google/callback
‚úÖ Google OAuth routes configured
üöÄ Running initial trial expiration check...
üîç Checking for trial expirations...
Server running on http://localhost:3000
Error processing site my-site: Error: ENOENT: no such file or directory, open '/Users/admin/active-directory-website/public/sites/my-site/site.json'
    at async open (node:internal/fs/promises:640:25)
    at async Object.readFile (node:internal/fs/promises:1277:14)
    at async checkTrialExpirations (file:///Users/admin/active-directory-website/server.js:3736:37) {
  errno: -2,
  code: 'ENOENT',
  syscall: 'open',
  path: '/Users/admin/active-directory-website/public/sites/my-site/site.json'
}
Error processing site my-site-0d787wo6w: Error: ENOENT: no such file or directory, open '/Users/admin/active-directory-website/public/sites/my-site-0d787wo6w/site.json'
    at async open (node:internal/fs/promises:640:25)
    at async Object.readFile (node:internal/fs/promises:1277:14)
    at async checkTrialExpirations (file:///Users/admin/active-directory-website/server.js:3736:37) {
  errno: -2,
  code: 'ENOENT',
  syscall: 'open',
  path: '/Users/admin/active-directory-website/public/sites/my-site-0d787wo6w/site.json'
}
Error processing site my-site-tidqp5en8: Error: ENOENT: no such file or directory, open '/Users/admin/active-directory-website/public/sites/my-site-tidqp5en8/site.json'
    at async open (node:internal/fs/promises:640:25)
    at async Object.readFile (node:internal/fs/promises:1277:14)
    at async checkTrialExpirations (file:///Users/admin/active-directory-website/server.js:3736:37) {
  errno: -2,
  code: 'ENOENT',
  syscall: 'open',
  path: '/Users/admin/active-directory-website/public/sites/my-site-tidqp5en8/site.json'
}
Error processing site my-site-zj93k58j5: Error: ENOENT: no such file or directory, open '/Users/admin/active-directory-website/public/sites/my-site-zj93k58j5/site.json'
    at async open (node:internal/fs/promises:640:25)
    at async Object.readFile (node:internal/fs/promises:1277:14)
    at async checkTrialExpirations (file:///Users/admin/active-directory-website/server.js:3736:37) {
  errno: -2,
  code: 'ENOENT',
  syscall: 'open',
  path: '/Users/admin/active-directory-website/public/sites/my-site-zj93k58j5/site.json'
}
‚úÖ Trial expiration check complete
‚úÖ Database connected successfully
Query executed: { text: 'SELECT NOW()', duration: 165, rows: 1 }
‚úÖ Database connection test successful: { now: 2025-11-04T00:10:50.940Z }
üöÄ Initiating Google OAuth...
Callback URL: https://tenurial-subemarginate-fay.ngrok-free.dev/auth/google/callback
üéØ CALLBACK HIT - Starting passport authentication...
‚úÖ Database connected successfully
Query executed: {
  text: 'SELECT * FROM users WHERE email = $1',
  duration: 153,
  rows: 1
}
Query executed: {
  text: 'UPDATE users SET last_login = NOW() WHERE email = $1',
  duration: 21,
  rows: 1
}
üéØ Passport authenticate callback fired
Error: null
User: persylopez9@gmail.com
Info: {}
üî•üî•üî• OAUTH CALLBACK FIRED üî•üî•üî•
User email: persylopez9@gmail.com
User ID: c9ff275b-45f0-4d4b-90c8-55ac98819e43
User role: user
Token generated: eyJhbGciOiJIUzI1NiIs...
üîç Checking redirect logic...
Pending intent: undefined
Pending plan: undefined
‚úÖ REDIRECTING TO: /dashboard.html?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJjOWZmMjc1Yi00NWYwLTRkNGItOTBjOC01NWFjOTg4MTllNDMiLCJlbWFpbCI6InBlcnN5bG9wZXo5QGdtYWlsLmNvbSIsInJvbGUiOiJ1c2VyIiwiaWF0IjoxNzYyMjE1MDk0LCJleHAiOjE3NjI4MTk4OTR9.lSCaDOBT5CZmsw30zBiIZZMcVHDL4DZ78YMT9JboMb8
üöÄ User should now land on dashboard!
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 18,
  rows: 1
}
‚úÖ Database connected successfully
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 147,
  rows: 1
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 20,
  rows: 1
}
Query executed: {
  text: '\n' +
    '      SELECT \n' +
    '        id, subdomain, template_id, status, plan, \n' +
    '        published_at, created_at, ',
  duration: 23,
  rows: 2
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 19,
  rows: 1
}
Query executed: {
  text: '\n' +
    '      SELECT \n' +
    '        id, subdomain, template_id, status, plan, \n' +
    '        published_at, created_at, ',
  duration: 22,
  rows: 2
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 19,
  rows: 1
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 21,
  rows: 1
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 21,
  rows: 1
}
Query executed: {
  text: 'SELECT id FROM users WHERE email = $1',
  duration: 19,
  rows: 1
}
Query executed: {
  text: '\n' +
    '      INSERT INTO sites (\n' +
    '        id, user_id, subdomain, template_id, status, plan,\n' +
    '        publis',
  duration: 22,
  rows: 1
}
‚úÖ Database connected successfully
‚úÖ Database connected successfully
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 157,
  rows: 1
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 155,
  rows: 1
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 18,
  rows: 1
}
Query executed: {
  text: '\n' +
    '      SELECT \n' +
    '        id, subdomain, template_id, status, plan, \n' +
    '        published_at, created_at, ',
  duration: 22,
  rows: 3
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 20,
  rows: 1
}
Query executed: {
  text: '\n' +
    '      SELECT \n' +
    '        id, subdomain, template_id, status, plan, \n' +
    '        published_at, created_at, ',
  duration: 19,
  rows: 3
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 19,
  rows: 1
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 19,
  rows: 1
}
üöÄ Initiating Google OAuth...
Callback URL: https://tenurial-subemarginate-fay.ngrok-free.dev/auth/google/callback
üéØ CALLBACK HIT - Starting passport authentication...
‚úÖ Database connected successfully
Query executed: {
  text: 'SELECT * FROM users WHERE email = $1',
  duration: 141,
  rows: 1
}
Query executed: {
  text: 'UPDATE users SET last_login = NOW() WHERE email = $1',
  duration: 21,
  rows: 1
}
üéØ Passport authenticate callback fired
Error: null
User: persylopez9@gmail.com
Info: {}
üî•üî•üî• OAUTH CALLBACK FIRED üî•üî•üî•
User email: persylopez9@gmail.com
User ID: c9ff275b-45f0-4d4b-90c8-55ac98819e43
User role: user
Token generated: eyJhbGciOiJIUzI1NiIs...
üîç Checking redirect logic...
Pending intent: undefined
Pending plan: undefined
‚úÖ REDIRECTING TO: /dashboard.html?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJjOWZmMjc1Yi00NWYwLTRkNGItOTBjOC01NWFjOTg4MTllNDMiLCJlbWFpbCI6InBlcnN5bG9wZXo5QGdtYWlsLmNvbSIsInJvbGUiOiJ1c2VyIiwiaWF0IjoxNzYyMjE1MjY2LCJleHAiOjE3NjI4MjAwNjZ9.CkrpcL3IsP_D4TTD8aQJJiroctqx8vl3xwk1QX7UDTI
üöÄ User should now land on dashboard!
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 19,
  rows: 1
}
‚úÖ Database connected successfully
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 152,
  rows: 1
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 19,
  rows: 1
}
Query executed: {
  text: '\n' +
    '      SELECT \n' +
    '        id, subdomain, template_id, status, plan, \n' +
    '        published_at, created_at, ',
  duration: 22,
  rows: 3
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 19,
  rows: 1
}
Query executed: {
  text: '\n' +
    '      SELECT \n' +
    '        id, subdomain, template_id, status, plan, \n' +
    '        published_at, created_at, ',
  duration: 19,
  rows: 3
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 19,
  rows: 1
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 20,
  rows: 1
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 21,
  rows: 1
}
Query executed: {
  text: 'SELECT subdomain FROM sites WHERE id = $1 AND user_id = $2',
  duration: 20,
  rows: 1
}
Query executed: {
  text: 'DELETE FROM sites WHERE id = $1 AND user_id = $2',
  duration: 45,
  rows: 1
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 18,
  rows: 1
}
Query executed: {
  text: '\n' +
    '      SELECT \n' +
    '        id, subdomain, template_id, status, plan, \n' +
    '        published_at, created_at, ',
  duration: 21,
  rows: 2
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 18,
  rows: 1
}
Query executed: {
  text: '\n' +
    '      SELECT \n' +
    '        id, subdomain, template_id, status, plan, \n' +
    '        published_at, created_at, ',
  duration: 21,
  rows: 2
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 19,
  rows: 1
}
Query executed: {
  text: 'SELECT subdomain FROM sites WHERE id = $1 AND user_id = $2',
  duration: 19,
  rows: 1
}
Query executed: {
  text: 'DELETE FROM sites WHERE id = $1 AND user_id = $2',
  duration: 20,
  rows: 1
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 20,
  rows: 1
}
Query executed: {
  text: '\n' +
    '      SELECT \n' +
    '        id, subdomain, template_id, status, plan, \n' +
    '        published_at, created_at, ',
  duration: 21,
  rows: 1
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 19,
  rows: 1
}
Query executed: {
  text: '\n' +
    '      SELECT \n' +
    '        id, subdomain, template_id, status, plan, \n' +
    '        published_at, created_at, ',
  duration: 18,
  rows: 1
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 21,
  rows: 1
}
Query executed: {
  text: 'SELECT subdomain FROM sites WHERE id = $1 AND user_id = $2',
  duration: 19,
  rows: 1
}
Query executed: {
  text: 'DELETE FROM sites WHERE id = $1 AND user_id = $2',
  duration: 20,
  rows: 1
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 21,
  rows: 1
}
Query executed: {
  text: '\n' +
    '      SELECT \n' +
    '        id, subdomain, template_id, status, plan, \n' +
    '        published_at, created_at, ',
  duration: 20,
  rows: 0
}
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 18,
  rows: 1
}
Query executed: {
  text: '\n' +
    '      SELECT \n' +
    '        id, subdomain, template_id, status, plan, \n' +
    '        published_at, created_at, ',
  duration: 19,
  rows: 0
}
‚úÖ Database connected successfully
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 3986,
  rows: 1
}
‚úÖ Database connected successfully
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 157,
  rows: 1
}
‚úÖ Database connected successfully
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 1405,
  rows: 1
}
‚úÖ Database connected successfully
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 160,
  rows: 1
}
‚úÖ Database connected successfully
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 180,
  rows: 1
}
‚úÖ Database connected successfully
Query executed: {
  text: 'SELECT id, email, role, status, subscription_status, subscription_plan FROM users WHERE id = $1',
  duration: 134,
  rows: 1
}
